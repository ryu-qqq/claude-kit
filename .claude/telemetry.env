# Claude Code Default Telemetry Configuration
# This file enables telemetry collection by default

# Enable Claude Code telemetry
export CLAUDE_CODE_ENABLE_TELEMETRY=1

# Default OTEL configuration for development
export OTEL_SERVICE_NAME="claude-code"
export OTEL_SERVICE_VERSION="1.0.0"
export OTEL_RESOURCE_ATTRIBUTES="service.name=claude-code,deployment.environment=local,user.id=$(whoami),host.name=$(hostname)"

# OTLP Exporter settings (will try local collector first, fallback to console)
export OTEL_EXPORTER_OTLP_PROTOCOL=grpc
export OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# Performance settings
export OTEL_BSP_EXPORT_TIMEOUT=2000
export OTEL_BSP_BATCH_EXPORT_SIZE=512
export OTEL_BSP_SCHEDULE_DELAY=1000
export OTEL_METRIC_EXPORT_INTERVAL=5000

# Enable all signal types
export OTEL_TRACES_EXPORTER=otlp
export OTEL_METRICS_EXPORTER=otlp  
export OTEL_LOGS_EXPORTER=otlp

# Logging configuration
export OTEL_LOG_LEVEL=info

# Sampling configuration (collect all traces in development)
export OTEL_TRACES_SAMPLER=always_on
export OTEL_TRACES_SAMPLER_ARG=1.0

# Disable SDK for now if no collector is available (prevents noise)
# This will be overridden by the detection script when collector is available
if ! timeout 1 bash -c "</dev/tcp/localhost/4317" 2>/dev/null; then
    export OTEL_SDK_DISABLED=false  # Keep enabled, but will fallback to console exporter
fi